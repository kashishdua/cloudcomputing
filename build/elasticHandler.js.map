{"version":3,"sources":["../src/elasticHandler.js"],"names":["module","exports","elastic_client","io","tweet","Object","keys","length","index","type","body","err","resp","status","console","log"],"mappings":";;AAAA;;;;;;AAEAA,OAAOC,OAAP,GAAiB,UAASC,cAAT,EAAyBC,EAAzB,EAA6BC,KAA7B,EAAoC;AACjD,QAAG,CAACF,cAAJ,EAAoB;AAChB;AACH;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,QAAIG,OAAOC,IAAP,CAAYF,KAAZ,EAAmBG,MAAnB,GAA4B,CAAhC,EAAmC;AAC/BL,uBAAeM,KAAf,CAAqB;AACjBA,mBAAO,QADU;AAEjBC,kBAAM,OAFW;AAGjBC,kBAAMN;AAHW,SAArB,EAIE,UAASO,GAAT,EAAaC,IAAb,EAAkBC,MAAlB,EAA0B;AACxBC,oBAAQC,GAAR,CAAYH,IAAZ;AACH,SAND;AAOH;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACH,CA1ED","file":"elasticHandler.js","sourcesContent":["import fs from 'fs';\n\nmodule.exports = function(elastic_client, io, tweet) {\n    if(!elastic_client) {\n        return;\n    }\n\n    // let tweets1 = require('../finaltweets1.json');\n    // console.log(tweets1.length);\n    // fs.readFile('./finaltweets1.json', 'utf8', function (err, data) {\n    //     if (err) throw err; // we'll not consider error handling for now\n    //     var obj = JSON.parse(data);\n    //     console.log(obj.length);\n    // });\n\n    //index the passed tweet\n    if (Object.keys(tweet).length > 0) {\n        elastic_client.index({  \n            index: 'tweets',\n            type: 'tweet',\n            body: tweet\n        },function(err,resp,status) {\n            console.log(resp);\n        });\n    }\n\n    // Check how many there inside.\n    // elastic_client.count({index: 'tweets',type: 'tweet'},function(err,resp,status) {  \n    //     console.log(\"tweets\",resp);\n    // });\n\n    // Run a search , emit to client side\n    // elastic_client.search({\n    //     index: 'tweets',\n    //     type: 'tweet',\n    //     body: {\n    //         query: {\n    //             // term: { \"constituencyname\": \"Harwich\" }\n    //             // \"range\" : {\n    //             //     \"Date\" : {\n    //             //         \"gte\" : '2016-04-16',\n    //             //         \"lt\" : '2016-05-16'\n    //             //     }\n    //             // },\n    //             \"term\" : { \"Tweet content\" : \"today\" }\n    //         },\n    //     }\n    // },function (error, response,status) {\n    //     if (error){\n    //         console.log(\"search error: \"+error)\n    //     }\n    //     else {\n    //         console.log(\"--- Response ---\");\n    //         console.log(response);\n    //         console.log(\"--- Hits ---\");\n    //         response.hits.hits.forEach(function(hit){\n    //             //send to client\n    //             io.emit('tweet', hit._source);\n    //             console.log(hit._source);\n    //         });\n    //     }\n    // });\n    \n    //Delete indexed tweets\n    // for(let i=0;i<22;i++) {\n    //     elastic_client.delete({  \n    //     index: 'tweets',\n    //     id: i,\n    //     type: 'tweet'\n    //     },function(err,resp,status) {\n    //         console.log(resp);\n    //         elastic_client.count({index: 'tweets',type: 'tweet'},function(err,resp,status) {  \n    //             console.log(\"tweet\",resp);\n    //         });\n    //     });\n    // }\n};"]}