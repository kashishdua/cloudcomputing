{"version":3,"sources":["../src/elasticHandler.js"],"names":["module","exports","elastic_client","io","tweet","search","index","type","body","query","error","response","status","console","log","hits","forEach","hit","emit","_source"],"mappings":";;AAAAA,OAAOC,OAAP,GAAiB,UAASC,cAAT,EAAyBC,EAAzB,EAA6BC,KAA7B,EAAoC;AACjD,QAAG,CAACF,cAAJ,EAAoB;AAChB;AACH;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACAA,mBAAeG,MAAf,CAAsB;AAClBC,eAAO,QADW;AAElBC,cAAM,OAFY;AAGlBC,cAAM;AACFC,mBAAO;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAS,EAAE,iBAAkB,OAApB;AARN;AADL;AAHY,KAAtB,EAeE,UAAUC,KAAV,EAAiBC,QAAjB,EAA0BC,MAA1B,EAAkC;AAChC,YAAIF,KAAJ,EAAU;AACNG,oBAAQC,GAAR,CAAY,mBAAiBJ,KAA7B;AACH,SAFD,MAGK;AACDG,oBAAQC,GAAR,CAAY,kBAAZ;AACAD,oBAAQC,GAAR,CAAYH,QAAZ;AACAE,oBAAQC,GAAR,CAAY,cAAZ;AACAH,qBAASI,IAAT,CAAcA,IAAd,CAAmBC,OAAnB,CAA2B,UAASC,GAAT,EAAa;AACpC;AACAd,mBAAGe,IAAH,CAAQ,OAAR,EAAiBD,IAAIE,OAArB;AACAN,wBAAQC,GAAR,CAAYG,IAAIE,OAAhB;AACH,aAJD;AAKH;AACJ,KA7BD;;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACH,CAlED","file":"elasticHandler.js","sourcesContent":["module.exports = function(elastic_client, io, tweet) {\n    if(!elastic_client) {\n        return;\n    }\n\n    //index the passed tweet\n    // if (Object.keys(tweet).length > 0) {\n    //     elastic_client.index({  \n    //         index: 'tweets',\n    //         type: 'tweet',\n    //         body: tweet\n    //     },function(err,resp,status) {\n    //         console.log(resp);\n    //     });\n    // }\n\n    //Check how many there inside.\n    // elastic_client.count({index: 'tweets',type: 'tweet'},function(err,resp,status) {  \n    //     console.log(\"tweets\",resp);\n    // });\n\n    // Run a search , emit to client side\n    elastic_client.search({\n        index: 'tweets',\n        type: 'tweet',\n        body: {\n            query: {\n                // term: { \"constituencyname\": \"Harwich\" }\n                // \"range\" : {\n                //     \"Date\" : {\n                //         \"gte\" : '2016-04-16',\n                //         \"lt\" : '2016-05-16'\n                //     }\n                // },\n                \"term\" : { \"Tweet content\" : \"today\" }\n            },\n        }\n    },function (error, response,status) {\n        if (error){\n            console.log(\"search error: \"+error)\n        }\n        else {\n            console.log(\"--- Response ---\");\n            console.log(response);\n            console.log(\"--- Hits ---\");\n            response.hits.hits.forEach(function(hit){\n                //send to client\n                io.emit('tweet', hit._source);\n                console.log(hit._source);\n            });\n        }\n    });\n    \n    //Delete indexed tweets\n    // for(let i=0;i<22;i++) {\n    //     elastic_client.delete({  \n    //     index: 'tweets',\n    //     id: i,\n    //     type: 'tweet'\n    //     },function(err,resp,status) {\n    //         console.log(resp);\n    //         elastic_client.count({index: 'tweets',type: 'tweet'},function(err,resp,status) {  \n    //             console.log(\"tweet\",resp);\n    //         });\n    //     });\n    // }\n};"]}