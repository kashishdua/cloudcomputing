{"version":3,"sources":["../src/streamHandler.js"],"names":["module","exports","stream","io","writableStream","createWriteStream","on","data","tweet","author","get","avatar","body","date","screenname","favs","retweets","loc_name","loc_lat","loc_lon","console","log","tweetEntry","save","err","emit"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;;;AAEA;AACAA,OAAOC,OAAP,GAAiB,UAASC,MAAT,EAAiBC,EAAjB,EAAqB;AAClC,QAAIC,iBAAiB,aAAGC,iBAAH,CAAqB,eAArB,CAArB;;AAEAH,WAAOI,EAAP,CAAU,MAAV,EAAiB,UAACC,IAAD,EAAU;AACvB;AACA,YAAIC,QAAQ;AACRC,oBAAQ,iBAAEC,GAAF,CAAMH,IAAN,EAAY,WAAZ,CADA;AAERI,oBAAQ,iBAAED,GAAF,CAAMH,IAAN,EAAW,wBAAX,CAFA;AAGRK,kBAAM,iBAAEF,GAAF,CAAMH,IAAN,EAAY,MAAZ,CAHE;AAIRM,kBAAM,iBAAEH,GAAF,CAAMH,IAAN,EAAY,YAAZ,CAJE;AAKRO,wBAAY,iBAAEJ,GAAF,CAAMH,IAAN,EAAY,kBAAZ,CALJ;AAMRQ,kBAAM,iBAAEL,GAAF,CAAMH,IAAN,EAAW,gBAAX,CANE;AAORS,sBAAU,iBAAEN,GAAF,CAAMH,IAAN,EAAW,eAAX,CAPF;AAQRU,sBAAU,iBAAEP,GAAF,CAAMH,IAAN,EAAW,iBAAX,CARF;AASRW,qBAAS,iBAAER,GAAF,CAAMH,IAAN,EAAW,4BAAX,KAA4C,iBAAEG,GAAF,CAAMH,IAAN,EAAW,oBAAX,CAT7C;AAURY,qBAAS,iBAAET,GAAF,CAAMH,IAAN,EAAW,4BAAX,KAA2C,iBAAEG,GAAF,CAAMH,IAAN,EAAW,oBAAX;AAV5C,SAAZ;AAYAa,gBAAQC,GAAR,CAAYb,KAAZ;AACA;;AAEA,YAAIc,aAAa,oBAAUd,KAAV,CAAjB;AACA;AACAc,mBAAWC,IAAX,CAAgB,UAASC,GAAT,EAAc;AAC1B,gBAAI,CAACA,GAAL,EAAU;AACN;AACAJ,wBAAQC,GAAR,CAAY,aAAZ;AACA;AACAlB,mBAAGsB,IAAH,CAAQ,OAAR,EAAiBjB,KAAjB;AACA;AACA;AACH;AACJ,SATD;AAUH,KA7BD;AA8BH,CAjCD","file":"streamHandler.js","sourcesContent":["import Tweet from './models/Tweet';\nimport _ from 'lodash';\nimport fs from 'fs';\n\n//Handles the twitter stream data, and socket io obj avail\nmodule.exports = function(stream, io) {\n    let writableStream = fs.createWriteStream('../tweets.txt');\n\n    stream.on('data',(data) => {\n        //tweet obj\n        let tweet = {\n            author: _.get(data, 'user.name'),\n            avatar: _.get(data,'user.profile_image_url'),\n            body: _.get(data, 'text'),\n            date: _.get(data, 'created_at'),\n            screenname: _.get(data, 'user.screen_name'),\n            favs: _.get(data,'favorite_count'),\n            retweets: _.get(data,'retweet_count'),\n            loc_name: _.get(data,'place.full_name'),\n            loc_lat: _.get(data,'coordinates.coordinates[1]') || _.get(data,'geo.coordinates[0]'),\n            loc_lon: _.get(data,'coordinates.coordinates[0]')|| _.get(data,'geo.coordinates[1]')\n        };\n        console.log(tweet);\n        // if (tweet.loc_lat && tweet.loc_lon) console.log(tweet);\n\n        let tweetEntry = new Tweet(tweet);\n        // Save 'er to the database\n        tweetEntry.save(function(err) {\n            if (!err) {\n                // If everything is cool, socket.io emits the tweet.\n                console.log('tweet saved');\n                //io.broadcast.emit('tweet', tweet);\n                io.emit('tweet', tweet);\n                //Write to File\n                // writableStream.write(tweet.body);\n            }\n        });\n    });\n};"]}